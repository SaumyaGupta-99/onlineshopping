"use strict";function escapeRegExp(i){return i.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}var piUtils={replaceAll:function(i,e,n){return i.replace(new RegExp(escapeRegExp(e),"g"),n)},format:function(i){var e=Array.prototype.slice.call(arguments,1);return i.replace(/{(\d+)}/g,function(i,n){return void 0!==e[n]?e[n]:i})},uuid:function(){var i,e,n="";for(i=0;i<32;i++)e=16*Math.random()|0,8!=i&&12!=i&&16!=i&&20!=i||(n+="-"),n+=(12==i?4:16==i?3&e|8:e).toString(16);return n},setCookie:function(i,e,n){var t="";if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),t="; expires="+o.toUTCString()}document.cookie=i+"="+(e||"")+t+"; path=/"},getCookie:function(i){for(var e=i+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){for(var o=n[t];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null},ajax:function(i,e,n,t){try{var o=new XMLHttpRequest;o.open(n?"POST":"GET",i,1),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){o.readyState>3&&e&&e(o.responseText,o)},o.send(n)}catch(i){window.location.href.indexOf("myntra.com")<0&&window.console&&console.log(i),t&&t(i)}},loadExt:function(i,e){var n=this;n.files=i,n.js=[],n.head=document.getElementsByTagName("head")[0],n.after=e||function(){},n.loadStyle=function(i){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=i,n.head.appendChild(e)},n.loadScript=function(i){var e=document.createElement("script");e.type="text/javascript",e.src=n.js[i];e.onload=function(){++i<n.js.length?n.loadScript(i):n.after()},n.head.appendChild(e)};for(var t=0;t<n.files.length;t++)/\.js$|\.js\?/.test(n.files[t])&&n.js.push(n.files[t]),/\.css$|\.css\?/.test(n.files[t])&&n.loadStyle(n.files[t]);n.js.length>0?n.loadScript(0):n.after()},convertToLbs:function(i){var e=(i=parseInt(i)<=0?50:i)/.45359237;return Math.floor(e)},convertFtToCM:function(i,e){""===i&&(i=0),""===e&&(e=0),i=parseInt(i)<=0?5:i,e=parseInt(e)<0?0:e;var n=Math.round(30.5*i+2.5*e);return n>200?200:n},convertToFt:function(i){""===i&&(i=0);var e=.3937*(i=parseInt(i)<=0?155:i)/12,n=Math.floor(e),t=Math.round(12*(e-n));return 12===t&&(t=0,n+=1),[n,t]},validateNumberKey:function(i){var e=window.event?i.keyCode:i.which;return 9===i.keyCode||8===i.keyCode||46===i.keyCode||!(e<48||e>57)}},piConfig={cookieName:"_pxb",clientId:"1jyjcjext4hgh",cdn:"",api:"https://sizeguidev2.pixibo.com",sku:"",uid:"",url:location.href,urlHasChanged:!1,hasWidgetBeenOpened:!1,skuType:"",gender:"female"},piCookieData={wtFmt:"kg",htFmt:"ft"},piModal={},fysPlugin={eventTrackingForMyntra:function(i,e){var n="",t="";"pdp"===i?(t="PDP - 3P size recommendation prompt on PDP",n="widgetLoad"):"findSize"===i?(t="PDP - 3P size recommendation click on Find Size",n="widgetClick"):"recommend"===i&&(t="PDP - 3P size recommended",n="widgetLoad");var o={event_type:n,event_category:"PDP",payload:{custom:{v1:"pixibo"},screen:{name:document.title,url:window.location.href,variant:"web",data_set:{entity_type:"product",entity_id:piConfig.sku,entity_optional_attributes:{sizefit_vendor:"pixibo"}}}}};"recommend"===i&&(o.payload.screen.data_set.entity_optional_attributes={},o.payload.screen.data_set.entity_optional_attributes.recommended_size=e,o.payload.screen.data_set.entity_optional_attributes.sizefit_vendor="pixibo"),window.Madalytics&&window.location.href.indexOf("localhost")<0&&window.Madalytics.sendRaw(t,o)},checkForURLChanges:function(){document.body.addEventListener("click",function(i){requestAnimationFrame(function(){piConfig.url!==location.href?(piConfig.url=location.href,piConfig.urlHasChanged=!0,fysPlugin.init()):piConfig.urlHasChanged=!1})},!0)},init:function(){(window.location.href.indexOf("localhost")>=0||window.location.href.indexOf("amazonaws")>=0)&&window.location.href.indexOf("bra")>=0?piConfig.sku="2399006":window.location.href.indexOf("localhost")>=0||window.location.href.indexOf("amazonaws")>=0?piConfig.sku="1224951":window.location.href.indexOf("buy")<0?piConfig.sku=window.location.href.split("/").pop().split("?")[0]:piConfig.sku=window.location.href.split("/").reverse()[1],piConfig.uid=fysPlugin.getOrSetUID(),fysPlugin.validateAndBind(),piConfig.hasWidgetBeenOpened=!1},setCDN:function(){var i=window.location.href;i.indexOf("localhost")>=0?piConfig.cdn="http://localhost:8080/dist":i.indexOf("www.myntra.com")>=0?piConfig.cdn="https://cdn.pixibo.com/clients/myntra/p":i.indexOf("amazonaws")>=0?piConfig.cdn="https://cdn.pixibo.com/clients/myntra/dev":piConfig.cdn="https://cdn.pixibo.com/clients/myntra/d"},getOrSetUID:function(i){var e=piUtils.getCookie(piConfig.cookieName);return e&&null!==e?(piCookieData=JSON.parse(e)).uid:(piCookieData.uid=void 0!==i?i:piUtils.uuid(),piUtils.setCookie(piConfig.cookieName,JSON.stringify(piCookieData),365),piCookieData.uid)},validateAndBind:function(){window.location.href.indexOf("myntra_men")>0&&(piConfig.sku="1223924");var i=piConfig.api+"/validate/"+piConfig.clientId+"/"+piConfig.sku+"?uid="+piConfig.uid;piUtils.ajax(i,function(i){JSON.parse(i)&&(JSON.parse(i).gcount>0||"Bra"===JSON.parse(i).type)&&(piConfig.skuType=JSON.parse(i).type,piConfig.gender=JSON.parse(i).gender,"male"===piConfig.gender.toLowerCase()&&(piConfig.cookieName=piConfig.cookieName+"_m",fysPlugin.getOrSetUID(piConfig.uid)),fysPlugin.addEntryPoint(),fysPlugin.eventTrackingForMyntra("pdp"))})},addEntryPoint:function(){for(var i=document.querySelector(".size-buttons-size-container"),e=document.getElementsByClassName("size-buttons-recoContainer");e.length>0;)e[0].remove();i&&("Bra"===piConfig.skuType&&void 0===piCookieData.wired||void 0===piCookieData.age)?i.insertAdjacentHTML("beforeEnd",'<div class="size-buttons-recText marginTop15"><div class=""><span><span class="piEntryPtTextColor">Not sure about what size to buy? </span><span class="size-buttons-viewSimilar fontWeight500 piLink" onClick="fysPlugin.initializeWidget();"> Find My Size</span></span></div></div>'):fysPlugin.initializeWidget()},initializeWidget:function(){document.getElementById("piFYFWidget")?piModal.open():((piModal=new tingle.modal({footer:!1,closeMethods:["overlay","escape"],onOpen:function(){if(fysPlugin.eventTrackingForMyntra("findSize"),!1===piConfig.hasWidgetBeenOpened&&window.location.href.indexOf("localhost")<0&&window.location.href.indexOf("amazonaws")<0){var i=piConfig.api+"/event/"+piConfig.clientId+"/"+piConfig.sku+"?uid="+piConfig.uid+"&eventType=click&page=pdp&event=fyfSizeSelection_widgetopen";piUtils.ajax(i),piConfig.hasWidgetBeenOpened=!0}}})).setContent('<div class="piLoadingDiv"><img class="piLoading" src="'+piConfig.cdn+'/images/loading.svg" alt="Loading Find your size"></div>'),(void 0===piCookieData.age||"Bra"===piConfig.skuType&&void 0===piCookieData.wired)&&piModal.open(),fysPlugin.downloadWidget())},downloadWidget:function(){"bra"===piConfig.skuType.toLowerCase()?piUtils.loadExt([piConfig.cdn+"/styles/fyfbra.css",piConfig.cdn+"/pixibo.default.desktop.bra.min.js"],function(){piUtils.ajax(piConfig.cdn+"/template/desktop/fysbra.html",function(i){fysPlugin.bindTemplate(i),fysBraWidget.init(),void 0!==piCookieData.wired&&(fysBraWidget.callSizeGuideService(),fysBraWidget.navigateTo(1))})}):piUtils.loadExt([piConfig.cdn+"/styles/fyf.css",piConfig.cdn+"/pixibo.default.desktop.min.js"],function(){piUtils.ajax(piConfig.cdn+"/template/desktop/fyf.html",function(i){"male"===piConfig.gender.toLowerCase()&&(i=piUtils.replaceAll(i,"BUST","CHEST")),fysPlugin.bindTemplate(i),fysWidget.init(),void 0!==piCookieData.band&&fysWidget.callSizeGuideService()})})},bindTemplate:function(i){i=piUtils.replaceAll(i,"{PICDN}",piConfig.cdn),piModal.setContent(i),piModal.checkOverflow(),"male"===piConfig.gender.toLowerCase()&&document.getElementById("piBraSizeParentDiv").classList.add("piHide")}};!1===piConfig.urlHasChanged&&(fysPlugin.setCDN(),piUtils.loadExt(["https://cdnjs.cloudflare.com/ajax/libs/tingle/0.13.2/tingle.min.js","https://cdnjs.cloudflare.com/ajax/libs/tingle/0.13.2/tingle.min.css",piConfig.cdn+"/styles/pi.css"],function(){fysPlugin.init(),fysPlugin.checkForURLChanges()}));